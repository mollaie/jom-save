(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{dtcG:function(l,n,o){"use strict";o.r(n);var u=o("CcnG"),t=o("mrSG"),e=o("e0iR"),i=o("603S"),r=o("ZZ/e"),s=o("utPD"),a=o("n6ga"),c=o("56ai"),b=function(){function l(l,n,o,u,t,e,i){var r=this;this.router=l,this.dataTransaction=n,this.api=o,this.platform=u,this.alert=t,this.restApi=e,this.routerProvider=i,this.AccessToken="",this.ErrorMessage="",this.BlockDuration=0,this.BlockDurationText="00:00",this.isUserHold=!1,this.isDebug=!1,this.Model={Phone:"",MailConfirmation:"",Resouses:{PhoneIcon:"",WorldPicture:"",PasswordIcon:"",ConfirmPassword:"",MailConfirmation:"",UserHold:""}},this.dataTransaction.getAccessToken().then(function(l){r.AccessToken=l}).catch(function(l){r.ErrorMessage="The system can not detect your corrent password. <br/> please log out and login again."}),this.isDebug=!u.is("cordova")}return l.prototype.ngOnInit=function(){var l=this;this.dataTransaction.getUserPhone().then(function(n){l.Model.Phone=n}).catch(function(n){l.alert.showErrorMessageAlert(n)})},l.prototype.doNext=function(){var l=this;this.isDebug?(this.dataTransaction.setEmail(this.Model.MailConfirmation),this.restApi.RequestEmailVerification(this.Model.MailConfirmation,this.AccessToken).subscribe(function(n){var o=l.restApi.converResponseToJson(n);"0"==o.ErrorCode?(l.BlockDuration=parseInt(o.Data.BlockDuration),l.doHoldUser()):l.ErrorMessage=o.ErrorMessage})):(this.dataTransaction.setEmail(this.Model.MailConfirmation),this.api.RequestEmailVerification(this.Model.MailConfirmation,this.AccessToken).then(function(n){if(200==n.status){var o=l.api.converResponseToJson(n.data);"0"==o.ErrorCode?(l.BlockDuration=parseInt(o.Data.BlockDuration),l.doHoldUser()):l.alert.showErrorMessageAlert(o.ErrorMessage)}else l.alert.showErrorMessageAlert(n.error)},function(n){l.alert.showErrorMessageAlert(n)}))},l.prototype.doHoldUser=function(){this.isUserHold=!0,this.countdown(),this.requestCountDown()},l.prototype.requestCountDown=function(){return t.b(this,void 0,void 0,function(){var l=this;return t.e(this,function(n){switch(n.label){case 0:return[4,setInterval(function(){l.doVerifyEmail()},5e3)];case 1:return n.sent(),[2]}})})},l.prototype.countdown=function(){return t.b(this,void 0,void 0,function(){var l=this;return t.e(this,function(n){switch(n.label){case 0:return[4,setTimeout(function(n){l.BlockDuration-=1,l.BlockDuration>0?(l.countdown(),l.BlockDurationText=l.parseTime(l.BlockDuration)):l.isUserHold=!1},1e3)];case 1:return n.sent(),[2]}})})},l.prototype.parseTime=function(l){var n;return(n=Math.round(l/60).toString())+":"+(l-60*parseInt(n)).toString()},l.prototype.doVerifyEmail=function(){var l=this;this.isDebug?this.restApi.GetProfile(this.AccessToken).subscribe(function(n){var o=l.restApi.converResponseToJson(n);"0"==o.ErrorCode&&"VerifyEmail"!=o.Data.NextStep&&(l.isUserHold=!1,l.BlockDuration=0,l.routerProvider.nextStep(o.Data.NextStep))}):this.api.GetProfile(this.AccessToken).then(function(n){if(200==n.status){var o=l.api.converResponseToJson(n.data);"VerifyEmail"!=o.Data.NextStep&&(l.isUserHold=!1,l.BlockDuration=0,l.routerProvider.nextStep(o.Data.NextStep))}else l.alert.showErrorMessageAlert(n.error)}).catch(function(n){return l.alert.showErrorMessageAlert(n)})},l.prototype.doLogin=function(){this.router.navigate(["auth-phone"])},l}(),p=function(){return function(){}}(),h=o("pMnS"),d=o("oBZk"),f=o("gIcY"),g=o("Ip0R"),m=o("yp2w"),w=o("uPsM"),k=o("ZYCi"),v=u.nb({encapsulation:0,styles:[[""]],data:{}});function M(l){return u.Db(0,[(l()(),u.pb(0,0,null,null,1,"span",[["color","danger"]],null,null,null,null,null)),(l()(),u.Cb(1,null,["",""]))],null,function(l,n){l(n,1,0,n.component.ErrorMessage)})}function D(l){return u.Db(0,[(l()(),u.pb(0,0,null,null,22,"ion-row",[["id","sendemail"]],null,null,null,d.S,d.s)),u.ob(1,49152,null,0,r.jb,[u.h,u.k],null,null),(l()(),u.pb(2,0,null,0,1,"ion-col",[["size","1"]],null,null,null,d.F,d.f)),u.ob(3,49152,null,0,r.u,[u.h,u.k],{size:[0,"size"]},null),(l()(),u.pb(4,0,null,0,2,"ion-col",[["size","2"]],null,null,null,d.F,d.f)),u.ob(5,49152,null,0,r.u,[u.h,u.k],{size:[0,"size"]},null),(l()(),u.pb(6,0,null,0,0,"img",[["src","../../assets/images/icon-email.svg"]],null,null,null,null,null)),(l()(),u.pb(7,0,null,0,13,"ion-col",[["size","7"]],null,null,null,d.F,d.f)),u.ob(8,49152,null,0,r.u,[u.h,u.k],{size:[0,"size"]},null),(l()(),u.pb(9,0,null,0,5,"input",[["class","forgot-password-input"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(l,n,o){var t=!0,e=l.component;return"input"===n&&(t=!1!==u.yb(l,10)._handleInput(o.target.value)&&t),"blur"===n&&(t=!1!==u.yb(l,10).onTouched()&&t),"compositionstart"===n&&(t=!1!==u.yb(l,10)._compositionStart()&&t),"compositionend"===n&&(t=!1!==u.yb(l,10)._compositionEnd(o.target.value)&&t),"ngModelChange"===n&&(t=!1!==(e.Model.MailConfirmation=o)&&t),t},null,null)),u.ob(10,16384,null,0,f.b,[u.D,u.k,[2,f.a]],null,null),u.zb(1024,null,f.f,function(l){return[l]},[f.b]),u.ob(12,671744,null,0,f.i,[[8,null],[8,null],[8,null],[6,f.f]],{model:[0,"model"]},{update:"ngModelChange"}),u.zb(2048,null,f.g,null,[f.i]),u.ob(14,16384,null,0,f.h,[[4,f.g]],null,null),(l()(),u.pb(15,0,null,0,3,"span",[["class","forgot-password-span"]],null,null,null,null,null)),(l()(),u.Cb(-1,null,["Please key in your email for "])),(l()(),u.pb(17,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),u.Cb(-1,null,[" verification purpose"])),(l()(),u.gb(16777216,null,0,1,null,M)),u.ob(20,16384,null,0,g.i,[u.O,u.L],{ngIf:[0,"ngIf"]},null),(l()(),u.pb(21,0,null,0,1,"ion-col",[["size","2"]],null,null,null,d.F,d.f)),u.ob(22,49152,null,0,r.u,[u.h,u.k],{size:[0,"size"]},null)],function(l,n){var o=n.component;l(n,3,0,"1"),l(n,5,0,"2"),l(n,8,0,"7"),l(n,12,0,o.Model.MailConfirmation),l(n,20,0,""!=o.ErrorMessage),l(n,22,0,"2")},function(l,n){l(n,9,0,u.yb(n,14).ngClassUntouched,u.yb(n,14).ngClassTouched,u.yb(n,14).ngClassPristine,u.yb(n,14).ngClassDirty,u.yb(n,14).ngClassValid,u.yb(n,14).ngClassInvalid,u.yb(n,14).ngClassPending)})}function y(l){return u.Db(0,[(l()(),u.pb(0,0,null,null,6,"ion-row",[],null,null,null,d.S,d.s)),u.ob(1,49152,null,0,r.jb,[u.h,u.k],null,null),(l()(),u.pb(2,0,null,0,4,"ion-col",[["class","text-center"]],null,null,null,d.F,d.f)),u.ob(3,49152,null,0,r.u,[u.h,u.k],null,null),(l()(),u.pb(4,0,null,0,0,"img",[["src","../../assets/images/stop.png"],["width","250"]],null,null,null,null,null)),(l()(),u.pb(5,0,null,0,1,"h4",[["class","text-center"]],null,null,null,null,null)),(l()(),u.Cb(6,null,["Waiting for email verified ",""]))],null,function(l,n){l(n,6,0,n.component.BlockDurationText)})}function C(l){return u.Db(0,[(l()(),u.pb(0,0,null,null,3,"ion-fab-button",[["class","next-button"]],null,[[null,"click"]],function(l,n,o){var u=!0;return"click"===n&&(u=!1!==l.component.doNext()&&u),u},d.I,d.i)),u.ob(1,49152,null,0,r.y,[u.h,u.k],null,null),(l()(),u.pb(2,0,null,0,1,"ion-icon",[["name","arrow-forward"]],null,null,null,d.L,d.l)),u.ob(3,49152,null,0,r.D,[u.h,u.k],{name:[0,"name"]},null)],function(l,n){l(n,3,0,"arrow-forward")},null)}function E(l){return u.Db(0,[(l()(),u.pb(0,0,null,null,3,"ion-header",[["no-border",""]],null,null,null,d.K,d.k)),u.ob(1,49152,null,0,r.C,[u.h,u.k],null,null),(l()(),u.pb(2,0,null,0,1,"ion-toolbar",[],null,null,null,d.Z,d.z)),u.ob(3,49152,null,0,r.Cb,[u.h,u.k],null,null),(l()(),u.pb(4,0,null,null,15,"ion-content",[],null,null,null,d.G,d.g)),u.ob(5,49152,null,0,r.v,[u.h,u.k],null,null),(l()(),u.pb(6,0,null,0,13,"div",[["class","container"]],null,null,null,null,null)),(l()(),u.pb(7,0,null,null,10,"ion-grid",[],null,null,null,d.J,d.j)),u.ob(8,49152,null,0,r.B,[u.h,u.k],null,null),(l()(),u.pb(9,0,null,0,4,"ion-row",[],null,null,null,d.S,d.s)),u.ob(10,49152,null,0,r.jb,[u.h,u.k],null,null),(l()(),u.pb(11,0,null,0,2,"ion-col",[],null,null,null,d.F,d.f)),u.ob(12,49152,null,0,r.u,[u.h,u.k],null,null),(l()(),u.pb(13,0,null,0,0,"div",[["class","logo"]],null,null,null,null,null)),(l()(),u.gb(16777216,null,0,1,null,D)),u.ob(15,16384,null,0,g.i,[u.O,u.L],{ngIf:[0,"ngIf"]},null),(l()(),u.gb(16777216,null,0,1,null,y)),u.ob(17,16384,null,0,g.i,[u.O,u.L],{ngIf:[0,"ngIf"]},null),(l()(),u.gb(16777216,null,null,1,null,C)),u.ob(19,16384,null,0,g.i,[u.O,u.L],{ngIf:[0,"ngIf"]},null)],function(l,n){var o=n.component;l(n,15,0,!o.isUserHold),l(n,17,0,o.isUserHold),l(n,19,0,!o.isUserHold)},null)}function T(l){return u.Db(0,[(l()(),u.pb(0,0,null,null,2,"app-mail-confirmation",[],null,null,null,E,v)),u.zb(512,null,i.a,i.a,[m.a,r.Jb,w.a]),u.ob(2,114688,null,0,b,[k.n,e.a,i.a,r.Jb,s.a,a.a,c.a],null,null)],function(l,n){l(n,2,0)},null)}var I=u.lb("app-mail-confirmation",b,T,{},{},[]);o.d(n,"MailConfirmationPageModuleNgFactory",function(){return A});var A=u.mb(p,[],function(l){return u.vb([u.wb(512,u.j,u.bb,[[8,[h.a,I]],[3,u.j],u.x]),u.wb(4608,g.k,g.j,[u.u,[2,g.r]]),u.wb(4608,f.l,f.l,[]),u.wb(4608,r.c,r.c,[u.z,u.g]),u.wb(4608,r.Hb,r.Hb,[r.c,u.j,u.q]),u.wb(4608,r.Kb,r.Kb,[r.c,u.j,u.q]),u.wb(1073742336,g.b,g.b,[]),u.wb(1073742336,f.j,f.j,[]),u.wb(1073742336,f.c,f.c,[]),u.wb(1073742336,r.Eb,r.Eb,[]),u.wb(1073742336,k.o,k.o,[[2,k.u],[2,k.n]]),u.wb(1073742336,p,p,[]),u.wb(1024,k.l,function(){return[[{path:"",component:b}]]},[])])})}}]);