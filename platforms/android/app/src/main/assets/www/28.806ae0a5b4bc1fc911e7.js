(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{bzfP:function(l,n,e){"use strict";e.r(n);var u=e("CcnG"),t=e("mrSG"),o=e("e0iR"),r=e("BoD5"),i=e("ZYCi"),s=e("ZZ/e"),a=e("n6ga"),c=e("603S"),b=e("HBAR"),d=e("56ai"),p=e("utPD"),h=e("AytR"),f=function(){function l(l,n,e,u,t,o,r,s,a){var c=this;this.router=l,this.dataTransaction=n,this.restApi=e,this.api=u,this.platform=t,this.themeableBrowser=o,this.routerProvider=r,this.constantService=s,this.alert=a,this.Model={Phone:"",CreditCard:"",ExpireDate:"",CVV:"",Name:""},this.AccessToken="",this.ErrorMessage="",this.isMethodCalled=!1,this.isDebug=!1,this.isScriptExecuted=!1,this.isStillHold=!1,l.events.subscribe(function(l){l instanceof i.d&&c.ngOnInit()})}return l.prototype.ngOnInit=function(){var l=this;this.dataTransaction.getAccessToken().then(function(n){null==n?console.log("access token does not detected"):l.AccessToken=n.toString()})},l.prototype.doLogin=function(){this.router.navigate(["auth-phone"])},l.prototype.doNext=function(){},l.prototype.doCredit=function(){this.router.navigate(["top-up-account-info"])},l.prototype.doBank=function(){this.createOrder()},l.prototype.doSkip=function(){console.log("skip clicked"),this.router.navigate(["change-password"])},l.prototype.createOrder=function(){var l=this;if(!this.isMethodCalled){this.isMethodCalled=!0;var n=this.Model.ExpireDate.substring(0,4),e=this.Model.ExpireDate.replace(n+"-","");this.isDebug?this.restApi.CreateOrder("Subscription",h.a.orderAmount,this.AccessToken).subscribe(function(u){console.log(u);var t=l.restApi.converResponseToJson(u);if(null!=t&&0==t.ErrorCode){var o=l.createModel(t.Data,e,n);l.createPaymentForm(o)}else l.ErrorMessage=t.ErrorMessage},function(l){}):this.api.CreateOrder("Subscription",h.a.orderAmount,this.AccessToken).then(function(u){if(200==u.status){var t=l.api.converResponseToJson(u.data);if(null!=t&&0==t.ErrorCode){var o=l.createModel(t.Data,e,n);l.createPaymentForm(o)}else l.alert.showErrorMessageAlert("API Error = "+t.ErrorMessage)}}).catch(function(n){l.alert.showErrorMessageAlert("System Error "+n)})}},l.prototype.createModel=function(l,n,e){var u={merchantId:l.MerchantId,amount:h.a.orderAmount,orderRef:l.OrderRef,successUrl:l.SuccessUrl,failUrl:l.FailUrl,errorUrl:l.ErrorUrl,secureHash:l.Hash,lang:"E",currCode:"458",payType:"N",remark:"JOMSAVE_KSJOA01B3YHD7dUS5CXX01HD6X64P0B1QDD",cardNo:"",securityCode:"",epMonth:"",epYear:"",cardHolder:"",pMethod:"MyClear"};return this.alert.showErrorMessageAlert(JSON.stringify(u)),u},l.prototype.createPaymentForm=function(l){var n=this,e='var form = document.createElement("form");';for(var u in e+='form.method="post";',e+='form.setAttribute("action","https://test.paydollar.com/b2cDemo/eng/dPayment/payComp.jsp");',l)e+="var "+u+'hiddenField = document.createElement("input");',e+=u+'hiddenField.setAttribute("type", "hidden");',e+=u+'hiddenField.setAttribute("name","'+u+'");',e+=u+'hiddenField.setAttribute("value","'+l[u]+'");',e+="form.appendChild("+u+"hiddenField);";e+="document.body.appendChild(form);",e+="form.submit();";try{var t=this.themeableBrowser.create("https://member.jomsave.com/Home/TutorialSlides","_blank",{toolbar:{height:44,color:"#fbb03b"},title:{color:"#ffffffff",showPageTitle:!0,staticText:"JomSave"},backButton:{image:"back",imagePressed:"back_pressed",align:"left",event:"backPressed"},forwardButton:{image:"forward",imagePressed:"forward_pressed",align:"left",event:"forwardPressed"},closeButton:{image:"close",imagePressed:"close_pressed",align:"left",event:"closePressed"},backButtonCanClose:!1});t.on("closePressed").subscribe(function(l){t.close(),n.isMethodCalled=!1}),t.on("exit").subscribe(function(l){n.isStillHold=!0,n.isMethodCalled=!1,n.doCallGetProfile()}),t.on("loadstop").subscribe(function(l){n.isScriptExecuted||t.executeScript({code:e}).then(function(l){n.isScriptExecuted=!0})})}catch(o){this.alert.showErrorMessageAlert(o)}},l.prototype.doCallGetProfile=function(){var l=this;setTimeout(function(){l.isStillHold&&l.doGetProfile()},5e3)},l.prototype.doGetProfile=function(){return t.b(this,void 0,void 0,function(){var l=this;return t.e(this,function(n){switch(n.label){case 0:return this.isDebug?[3,2]:[4,this.api.GetProfile(this.AccessToken).then(function(n){if(200==n.status){l.isStillHold=!1;var e=l.api.converResponseToJson(n.data);l.dataTransaction.setProfile(e.Data),l.routerProvider.nextStep(e.Data.NextStep)}}).catch(function(n){l.alert.showErrorMessageAlert(n)})];case 1:return n.sent(),[3,4];case 2:return[4,this.restApi.GetProfile(this.AccessToken).subscribe(function(n){var e=l.restApi.converResponseToJson(n);null!=e?(l.isStillHold=!1,l.dataTransaction.setProfile(e.Data),l.routerProvider.nextStep(e.Data.NextStep)):l.ErrorMessage=e.ErrorMessage})];case 3:n.sent(),n.label=4;case 4:return[2]}})})},l}(),g=function(){return function(){}}(),k=e("pMnS"),m=e("oBZk"),v=u.nb({encapsulation:0,styles:[[""]],data:{}});function w(l){return u.Db(0,[(l()(),u.pb(0,0,null,null,7,"ion-header",[["no-border",""]],null,null,null,m.K,m.k)),u.ob(1,49152,null,0,s.C,[u.h,u.k],null,null),(l()(),u.pb(2,0,null,0,5,"ion-toolbar",[],null,null,null,m.Z,m.z)),u.ob(3,49152,null,0,s.Cb,[u.h,u.k],null,null),(l()(),u.pb(4,0,null,0,3,"ion-buttons",[["slot","end"]],null,null,null,m.D,m.d)),u.ob(5,49152,null,0,s.m,[u.h,u.k],null,null),(l()(),u.pb(6,0,null,0,1,"a",[["class","Login-Link"],["slot","end"]],null,[[null,"click"]],function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.doLogin()&&u),u},null,null)),(l()(),u.Cb(-1,null,[" Cancel"])),(l()(),u.pb(8,0,null,null,59,"ion-content",[],null,null,null,m.G,m.g)),u.ob(9,49152,null,0,s.v,[u.h,u.k],null,null),(l()(),u.pb(10,0,null,0,57,"div",[["class","container"]],null,null,null,null,null)),(l()(),u.pb(11,0,null,null,56,"ion-grid",[["style","position: fixed;width: 100%;z-index: 200"]],null,null,null,m.J,m.j)),u.ob(12,49152,null,0,s.B,[u.h,u.k],null,null),(l()(),u.pb(13,0,null,0,4,"ion-row",[],null,null,null,m.S,m.s)),u.ob(14,49152,null,0,s.jb,[u.h,u.k],null,null),(l()(),u.pb(15,0,null,0,2,"ion-col",[],null,null,null,m.F,m.f)),u.ob(16,49152,null,0,s.u,[u.h,u.k],null,null),(l()(),u.pb(17,0,null,0,0,"div",[["class","logo"]],null,null,null,null,null)),(l()(),u.pb(18,0,null,0,5,"ion-row",[],null,null,null,m.S,m.s)),u.ob(19,49152,null,0,s.jb,[u.h,u.k],null,null),(l()(),u.pb(20,0,null,0,3,"ion-col",[],null,null,null,m.F,m.f)),u.ob(21,49152,null,0,s.u,[u.h,u.k],null,null),(l()(),u.pb(22,0,null,0,1,"h3",[["class","warningMessage"]],null,null,null,null,null)),(l()(),u.Cb(-1,null,["RM100 Membership"])),(l()(),u.pb(24,0,null,0,9,"ion-row",[],null,null,null,m.S,m.s)),u.ob(25,49152,null,0,s.jb,[u.h,u.k],null,null),(l()(),u.pb(26,0,null,0,1,"ion-col",[["size","2"]],null,null,null,m.F,m.f)),u.ob(27,49152,null,0,s.u,[u.h,u.k],{size:[0,"size"]},null),(l()(),u.pb(28,0,null,0,3,"ion-col",[["size","8"]],null,null,null,m.F,m.f)),u.ob(29,49152,null,0,s.u,[u.h,u.k],{size:[0,"size"]},null),(l()(),u.pb(30,0,null,0,1,"p",[["class","text-center"]],null,null,null,null,null)),(l()(),u.Cb(-1,null,["Please select a payment method:"])),(l()(),u.pb(32,0,null,0,1,"ion-col",[["size","2"]],null,null,null,m.F,m.f)),u.ob(33,49152,null,0,s.u,[u.h,u.k],{size:[0,"size"]},null),(l()(),u.pb(34,0,null,0,27,"ion-row",[],null,null,null,m.S,m.s)),u.ob(35,49152,null,0,s.jb,[u.h,u.k],null,null),(l()(),u.pb(36,0,null,0,25,"ion-col",[],null,null,null,m.F,m.f)),u.ob(37,49152,null,0,s.u,[u.h,u.k],null,null),(l()(),u.pb(38,0,null,0,11,"div",[["class","creditcard"]],null,[[null,"click"]],function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.doCredit()&&u),u},null,null)),(l()(),u.pb(39,0,null,null,10,"ion-grid",[],null,null,null,m.J,m.j)),u.ob(40,49152,null,0,s.B,[u.h,u.k],null,null),(l()(),u.pb(41,0,null,0,8,"ion-row",[],null,null,null,m.S,m.s)),u.ob(42,49152,null,0,s.jb,[u.h,u.k],null,null),(l()(),u.pb(43,0,null,0,2,"ion-col",[["size","6"]],null,null,null,m.F,m.f)),u.ob(44,49152,null,0,s.u,[u.h,u.k],{size:[0,"size"]},null),(l()(),u.pb(45,0,null,0,0,"img",[["height","100"],["src","../../assets/images/btn-credit-card-active.svg"],["width","130"]],null,null,null,null,null)),(l()(),u.pb(46,0,null,0,3,"ion-col",[["size","6"]],null,null,null,m.F,m.f)),u.ob(47,49152,null,0,s.u,[u.h,u.k],{size:[0,"size"]},null),(l()(),u.pb(48,0,null,0,1,"h3",[["class","text-center creditcard-text"]],null,null,null,null,null)),(l()(),u.Cb(-1,null,["Credit Card"])),(l()(),u.pb(50,0,null,0,11,"div",[["class","onlinebanking"]],null,[[null,"click"]],function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.doBank()&&u),u},null,null)),(l()(),u.pb(51,0,null,null,10,"ion-grid",[],null,null,null,m.J,m.j)),u.ob(52,49152,null,0,s.B,[u.h,u.k],null,null),(l()(),u.pb(53,0,null,0,8,"ion-row",[],null,null,null,m.S,m.s)),u.ob(54,49152,null,0,s.jb,[u.h,u.k],null,null),(l()(),u.pb(55,0,null,0,2,"ion-col",[["size","6"]],null,null,null,m.F,m.f)),u.ob(56,49152,null,0,s.u,[u.h,u.k],{size:[0,"size"]},null),(l()(),u.pb(57,0,null,0,0,"img",[["height","100"],["src","../../assets/images/btn-bank-inactive.svg"],["width","130"]],null,null,null,null,null)),(l()(),u.pb(58,0,null,0,3,"ion-col",[["size","6"]],null,null,null,m.F,m.f)),u.ob(59,49152,null,0,s.u,[u.h,u.k],{size:[0,"size"]},null),(l()(),u.pb(60,0,null,0,1,"h3",[["class","text-center onlinebanking-text"]],null,null,null,null,null)),(l()(),u.Cb(-1,null,["Online Banking"])),(l()(),u.pb(62,0,null,0,5,"ion-row",[],null,null,null,m.S,m.s)),u.ob(63,49152,null,0,s.jb,[u.h,u.k],null,null),(l()(),u.pb(64,0,null,0,3,"ion-col",[],null,null,null,m.F,m.f)),u.ob(65,49152,null,0,s.u,[u.h,u.k],null,null),(l()(),u.pb(66,0,null,0,1,"a",[["class","Login-Link"]],null,[[null,"click"]],function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.doSkip()&&u),u},null,null)),(l()(),u.Cb(-1,null,["Skip ..."]))],function(l,n){l(n,27,0,"2"),l(n,29,0,"8"),l(n,33,0,"2"),l(n,44,0,"6"),l(n,47,0,"6"),l(n,56,0,"6"),l(n,59,0,"6")},null)}function C(l){return u.Db(0,[(l()(),u.pb(0,0,null,null,1,"app-top-up",[],null,null,null,w,v)),u.ob(1,114688,null,0,f,[i.n,o.a,a.a,c.a,s.Jb,b.a,d.a,r.a,p.a],null,null)],function(l,n){l(n,1,0)},null)}var S=u.lb("app-top-up",f,C,{},{},[]),M=e("Ip0R"),y=e("gIcY");e.d(n,"TopUpPageModuleNgFactory",function(){return P});var P=u.mb(g,[],function(l){return u.vb([u.wb(512,u.j,u.bb,[[8,[k.a,S]],[3,u.j],u.x]),u.wb(4608,M.k,M.j,[u.u,[2,M.r]]),u.wb(4608,y.l,y.l,[]),u.wb(4608,s.c,s.c,[u.z,u.g]),u.wb(4608,s.Hb,s.Hb,[s.c,u.j,u.q]),u.wb(4608,s.Kb,s.Kb,[s.c,u.j,u.q]),u.wb(1073742336,M.b,M.b,[]),u.wb(1073742336,y.j,y.j,[]),u.wb(1073742336,y.c,y.c,[]),u.wb(1073742336,s.Eb,s.Eb,[]),u.wb(1073742336,i.o,i.o,[[2,i.u],[2,i.n]]),u.wb(1073742336,g,g,[]),u.wb(1024,i.l,function(){return[[{path:"",component:f}]]},[])])})}}]);